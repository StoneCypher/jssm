<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>☕ Quick Start | JSSM, a JavaScript state machine - the FSM for FSL</title><meta name="description" content="Documentation for JSSM, a JavaScript state machine - the FSM for FSL"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><link rel="stylesheet" href="../assets/custom.css"/><script async src="../assets/search.js" id="search-script"></script><link rel="stylesheet" href="../assets/pages.css"/></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">JSSM, a JavaScript state machine - the FSM for FSL</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">JSSM, a JavaScript state machine - the FSM for FSL</a></li><li><span>Tutorials</span></li><li><a href="GettingStarted.html">☕ Quick Start</a></li></ul><h1> ☕ Quick Start </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#getting-started" id="getting-started" style="color: inherit; text-decoration: none;">
  <h1>Getting Started</h1>
</a>
<p>There&#39;s a tutorial on <a href="WhatAreStateMachines.html">what state machines are</a>
elsewhere; this page is on using this library.</p>
<p>Like many modern Javascript libraries, JSSM is available in many builds, on NPM,
on Github Packages, and from CDN.  JSSM is packaged as an <code>es6 module</code> for
modern node, modern browsers, and packagers; as a <code>commonjs module</code> for node
back to 2018 and older bundlers; and as an <code>iife</code> for classic browsers.  JSSM
also ships with typescript support, and full documentation.</p>
<p>Generally, you should be able to use the system you&#39;re used to, in whatever
environment you&#39;re used to - be that <code>include</code> or <code>require</code> or a <code>&lt;script&gt;</code> tag,
in node, browser, typescript, deno, es6 environments, es5 environments, modern
stuff, ancient stuff, whatever - and it should <em><strong>Just Work</strong></em> &trade;.</p>
<p>This tutorial works from CDN.  The next tutorial goes over how to work with
various environments, builds, and so on.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<a href="#just-getting-going-from-cdn" id="just-getting-going-from-cdn" style="color: inherit; text-decoration: none;">
  <h1>Just getting going from CDN</h1>
</a>
<p>To start with, let&#39;s do things the sloppy, &quot;just run already&quot; way.  We&#39;ll load
the library directly in the HTML, from CDN.</p>
<pre><code class="language-html"><span class="hl-11">&lt;!</span><span class="hl-10">doctype</span><span class="hl-1"> </span><span class="hl-12">html</span><span class="hl-11">&gt;</span><br/><span class="hl-11">&lt;</span><span class="hl-10">html</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-11">&lt;</span><span class="hl-10">head</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-10">script</span><span class="hl-13"> </span><span class="hl-12">type</span><span class="hl-13">=</span><span class="hl-14">&quot;text/javascript&quot;</span><br/><span class="hl-13">            </span><span class="hl-12">src</span><span class="hl-13">=</span><span class="hl-14">&quot;https://cdn.jsdelivr.net/npm/jssm/dist/jssm.es5.iife.min.js&quot;</span><span class="hl-11">&gt;</span><br/><span class="hl-13">    </span><span class="hl-11">&lt;/</span><span class="hl-10">script</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-11">&lt;/</span><span class="hl-10">head</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-11">&lt;/</span><span class="hl-10">html</span><span class="hl-11">&gt;</span>
</code></pre>
<p>At this point, you can already play with the library, in the developer console.</p>
<div class="youtube-embed"><iframe src="//www.youtube.com/embed/hIezzLrVvRQ?html5=1" frameborder="0" allowfullscreen></iframe></div>





<p>&nbsp;</p>
<p>&nbsp;</p>

<a href="#let39s-make-it-visible" id="let39s-make-it-visible" style="color: inherit; text-decoration: none;">
  <h1>Let&#39;s make it visible</h1>
</a>
<p>First, we need a toy traffic light.  Here&#39;s some HTML structure:</p>
<pre><code class="language-html"><span class="hl-11">&lt;!</span><span class="hl-10">doctype</span><span class="hl-1"> </span><span class="hl-12">html</span><span class="hl-11">&gt;</span><br/><span class="hl-11">&lt;</span><span class="hl-10">html</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-11">&lt;</span><span class="hl-10">head</span><span class="hl-11">&gt;</span><br/><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-10">title</span><span class="hl-11">&gt;</span><span class="hl-1">Traffic light example</span><span class="hl-11">&lt;/</span><span class="hl-10">title</span><span class="hl-11">&gt;</span><br/><span class="hl-1">  </span><span class="hl-11">&lt;/</span><span class="hl-10">head</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-11">&lt;</span><span class="hl-10">body</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-10">table</span><span class="hl-1"> </span><span class="hl-12">id</span><span class="hl-1">=</span><span class="hl-14">&quot;light&quot;</span><span class="hl-1"> </span><span class="hl-12">class</span><span class="hl-1">=</span><span class="hl-14">&quot;light_off&quot;</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-10">tr</span><span class="hl-11">&gt;&lt;</span><span class="hl-10">td</span><span class="hl-1"> </span><span class="hl-12">id</span><span class="hl-1">=</span><span class="hl-14">&quot;red&quot;</span><span class="hl-11">&gt;&lt;</span><span class="hl-10">span</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">span</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">td</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">tr</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-10">tr</span><span class="hl-11">&gt;&lt;</span><span class="hl-10">td</span><span class="hl-1"> </span><span class="hl-12">id</span><span class="hl-1">=</span><span class="hl-14">&quot;yellow&quot;</span><span class="hl-11">&gt;&lt;</span><span class="hl-10">span</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">span</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">td</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">tr</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-10">tr</span><span class="hl-11">&gt;&lt;</span><span class="hl-10">td</span><span class="hl-1"> </span><span class="hl-12">id</span><span class="hl-1">=</span><span class="hl-14">&quot;green&quot;</span><span class="hl-11">&gt;&lt;</span><span class="hl-10">span</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">span</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">td</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">tr</span><span class="hl-11">&gt;</span><br/><span class="hl-1">    </span><span class="hl-11">&lt;/</span><span class="hl-10">table</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-11">&lt;/</span><span class="hl-10">body</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-11">&lt;/</span><span class="hl-10">html</span><span class="hl-11">&gt;</span>
</code></pre>
<p>And a bit of CSS to get it to look just so:</p>
<pre><code class="language-html"><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-10">style</span><span class="hl-13"> </span><span class="hl-12">type</span><span class="hl-13">=</span><span class="hl-14">&quot;text/css&quot;</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-13">      </span><span class="hl-15">#light</span><span class="hl-13">    { </span><span class="hl-12">border-collapse</span><span class="hl-13">: </span><span class="hl-16">collapse</span><span class="hl-13">; }  </span><span class="hl-7">/* don&#39;t separate cells */</span><br/><span class="hl-13">      </span><span class="hl-15">#light</span><span class="hl-13"> </span><span class="hl-15">td</span><span class="hl-13"> { </span><span class="hl-12">border</span><span class="hl-13">: </span><span class="hl-8">2px</span><span class="hl-13"> </span><span class="hl-16">solid</span><span class="hl-13"> </span><span class="hl-16">#e3a31d</span><span class="hl-13">; }  </span><span class="hl-7">/* mildly darker orange border around cells */</span><br/><br/><span class="hl-13">      </span><span class="hl-15">#light</span><span class="hl-13"> </span><span class="hl-15">span</span><span class="hl-13"> {</span><br/><span class="hl-13">        </span><span class="hl-12">height</span><span class="hl-13">        : </span><span class="hl-8">4em</span><span class="hl-13">;              </span><span class="hl-7">/* size the lightbulb */</span><br/><span class="hl-13">        </span><span class="hl-12">width</span><span class="hl-13">         : </span><span class="hl-8">4em</span><span class="hl-13">;              </span><span class="hl-7">/* size the lightbulb */</span><br/><span class="hl-13">        </span><span class="hl-12">border</span><span class="hl-13">        : </span><span class="hl-8">2px</span><span class="hl-13"> </span><span class="hl-16">solid</span><span class="hl-13"> </span><span class="hl-16">black</span><span class="hl-13">;  </span><span class="hl-7">/* looks weird without an edge */</span><br/><span class="hl-13">        </span><span class="hl-12">border-radius</span><span class="hl-13"> : </span><span class="hl-8">50%</span><span class="hl-13">;              </span><span class="hl-7">/* make it round */</span><br/><span class="hl-13">        </span><span class="hl-12">display</span><span class="hl-13">       : </span><span class="hl-16">inline-block</span><span class="hl-13">;     </span><span class="hl-7">/* so that it will lay out margins correctly */</span><br/><span class="hl-13">        </span><span class="hl-12">margin</span><span class="hl-13">        : </span><span class="hl-8">0.5em</span><span class="hl-13">;            </span><span class="hl-7">/* space around bulb */</span><br/><span class="hl-13">      }</span><br/><br/><span class="hl-13">      </span><span class="hl-15">#red</span><span class="hl-13">    </span><span class="hl-15">span</span><span class="hl-13"> { </span><span class="hl-12">background-color</span><span class="hl-13">: </span><span class="hl-16">#300</span><span class="hl-13">; } </span><span class="hl-7">/* very dark when not lit */</span><br/><span class="hl-13">      </span><span class="hl-15">#yellow</span><span class="hl-13"> </span><span class="hl-15">span</span><span class="hl-13"> { </span><span class="hl-12">background-color</span><span class="hl-13">: </span><span class="hl-16">#220</span><span class="hl-13">; }</span><br/><span class="hl-13">      </span><span class="hl-15">#green</span><span class="hl-13">  </span><span class="hl-15">span</span><span class="hl-13"> { </span><span class="hl-12">background-color</span><span class="hl-13">: </span><span class="hl-16">#030</span><span class="hl-13">; }</span><br/><br/><span class="hl-13">      </span><span class="hl-15">.light_red</span><span class="hl-13">    </span><span class="hl-15">#red</span><span class="hl-13">    </span><span class="hl-15">span</span><span class="hl-13"> { </span><span class="hl-12">background-color</span><span class="hl-13">: </span><span class="hl-16">#F00</span><span class="hl-13">; } </span><span class="hl-7">/* bright when lit */</span><br/><span class="hl-13">      </span><span class="hl-15">.light_yellow</span><span class="hl-13"> </span><span class="hl-15">#yellow</span><span class="hl-13"> </span><span class="hl-15">span</span><span class="hl-13"> { </span><span class="hl-12">background-color</span><span class="hl-13">: </span><span class="hl-16">#EE0</span><span class="hl-13">; }</span><br/><span class="hl-13">      </span><span class="hl-15">.light_green</span><span class="hl-13">  </span><span class="hl-15">#green</span><span class="hl-13">  </span><span class="hl-15">span</span><span class="hl-13"> { </span><span class="hl-12">background-color</span><span class="hl-13">: </span><span class="hl-16">#0F0</span><span class="hl-13">; }</span><br/><br/><span class="hl-13">      </span><span class="hl-15">td</span><span class="hl-13"> { </span><span class="hl-12">background-color</span><span class="hl-13">: </span><span class="hl-16">#FCC550</span><span class="hl-13">; } </span><span class="hl-7">/* that yellow-slightly-orange frame */</span><br/><br/><span class="hl-13">    </span><span class="hl-11">&lt;/</span><span class="hl-10">style</span><span class="hl-11">&gt;</span>
</code></pre>
<p>We&#39;ll also add a bit of Javascript to make it usable.</p>
<pre><code class="language-html"><span class="hl-11">&lt;</span><span class="hl-10">script</span><span class="hl-13"> </span><span class="hl-12">type</span><span class="hl-13">=</span><span class="hl-14">&quot;text/javascript&quot;</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-13">  </span><span class="hl-4">function</span><span class="hl-13"> </span><span class="hl-6">light</span><span class="hl-13">(</span><span class="hl-2">what</span><span class="hl-13">) {</span><br/><span class="hl-13">    </span><span class="hl-0">if</span><span class="hl-13"> ([</span><span class="hl-3">&#39;red&#39;</span><span class="hl-13">,</span><span class="hl-3">&#39;yellow&#39;</span><span class="hl-13">,</span><span class="hl-3">&#39;green&#39;</span><span class="hl-13">,</span><span class="hl-3">&#39;off&#39;</span><span class="hl-13">].</span><span class="hl-6">includes</span><span class="hl-13">(</span><span class="hl-2">what</span><span class="hl-13">)) {</span><br/><span class="hl-13">      </span><span class="hl-2">document</span><span class="hl-13">.</span><span class="hl-6">getElementById</span><span class="hl-13">(</span><span class="hl-3">&#39;light&#39;</span><span class="hl-13">).</span><span class="hl-2">className</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> </span><span class="hl-3">`light_</span><span class="hl-4">${</span><span class="hl-2">what</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-13">;</span><br/><span class="hl-13">    }</span><br/><span class="hl-13">  }</span><br/><br/><span class="hl-11">&lt;/</span><span class="hl-10">script</span><span class="hl-11">&gt;</span>
</code></pre>
<p>End result should look a bit like this:</p>
<div class="youtube-embed"><iframe src="//www.youtube.com/embed/qG5UQs13kBo?html5=1" frameborder="0" allowfullscreen></iframe></div>





<p>&nbsp;</p>
<p>&nbsp;</p>

<a href="#wiring-up-the-machine-to-the-ui" id="wiring-up-the-machine-to-the-ui" style="color: inherit; text-decoration: none;">
  <h1>Wiring up the machine to the UI</h1>
</a>
<p>Next, let&#39;s have the machine and the UI interact a bit.</p>
<p>If you pull the CSS out from the previous example into a file called <code>tl.css</code>
and otherwise assume it hasn&#39;t changed, you&#39;re left with this:</p>
<pre><code class="language-html"><span class="hl-11">&lt;!</span><span class="hl-10">doctype</span><span class="hl-1"> </span><span class="hl-12">html</span><span class="hl-11">&gt;</span><br/><span class="hl-11">&lt;</span><span class="hl-10">html</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-11">&lt;</span><span class="hl-10">head</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-10">link</span><span class="hl-1"> </span><span class="hl-12">rel</span><span class="hl-1">=</span><span class="hl-14">&quot;stylesheet&quot;</span><span class="hl-1"> </span><span class="hl-12">type</span><span class="hl-1">=</span><span class="hl-14">&quot;text/css&quot;</span><span class="hl-1"> </span><span class="hl-12">href</span><span class="hl-1">=</span><span class="hl-14">&quot;tl.css&quot;</span><span class="hl-1"> </span><span class="hl-11">/&gt;</span><br/><br/><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-10">script</span><span class="hl-13"> </span><span class="hl-12">type</span><span class="hl-13">=</span><span class="hl-14">&quot;text/javascript&quot;</span><br/><span class="hl-13">            </span><span class="hl-12">src</span><span class="hl-13">=</span><span class="hl-14">&quot;./jssm.es5.iife.js&quot;</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">script</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-10">script</span><span class="hl-13"> </span><span class="hl-12">type</span><span class="hl-13">=</span><span class="hl-14">&quot;text/javascript&quot;</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-13">      </span><span class="hl-4">function</span><span class="hl-13"> </span><span class="hl-6">set_color</span><span class="hl-13">(</span><span class="hl-2">what</span><span class="hl-13">) {</span><br/><span class="hl-13">        </span><span class="hl-0">if</span><span class="hl-13"> ([</span><span class="hl-3">&#39;red&#39;</span><span class="hl-13">,</span><span class="hl-3">&#39;yellow&#39;</span><span class="hl-13">,</span><span class="hl-3">&#39;green&#39;</span><span class="hl-13">,</span><span class="hl-3">&#39;off&#39;</span><span class="hl-13">].</span><span class="hl-6">includes</span><span class="hl-13">(</span><span class="hl-2">what</span><span class="hl-13">)) {</span><br/><span class="hl-13">          </span><span class="hl-2">document</span><span class="hl-13">.</span><span class="hl-6">getElementById</span><span class="hl-13">(</span><span class="hl-3">&#39;light&#39;</span><span class="hl-13">).</span><span class="hl-2">className</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> </span><span class="hl-3">`light_</span><span class="hl-4">${</span><span class="hl-2">what</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-13">;</span><br/><span class="hl-13">        }</span><br/><span class="hl-13">      }</span><br/><br/><span class="hl-13">      </span><span class="hl-2">window</span><span class="hl-13">.</span><span class="hl-6">onload</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> () </span><span class="hl-4">=&gt;</span><span class="hl-13"> {</span><br/><br/><span class="hl-13">        </span><span class="hl-4">const</span><span class="hl-13"> </span><span class="hl-5">traffic_light</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> </span><span class="hl-6">sm</span><span class="hl-3">`</span><br/><span class="hl-3">          Red &#39;next&#39; =&gt; Green &#39;next&#39; =&gt; Yellow &#39;next&#39; =&gt; Red;</span><br/><span class="hl-3">        `</span><span class="hl-13">;</span><br/><br/><span class="hl-13">      };</span><br/><br/><span class="hl-13">    </span><span class="hl-11">&lt;/</span><span class="hl-10">script</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-11">&lt;/</span><span class="hl-10">head</span><span class="hl-11">&gt;</span><br/><br/><span class="hl-11">&lt;/</span><span class="hl-10">html</span><span class="hl-11">&gt;</span>
</code></pre>
<p>We&#39;ll add a simple &quot;hook,&quot; which means the state machine will call functions you
provide when things happen.  In this case, we&#39;ll call the hook whenever any
state is entered.</p>
<p>Hooks take an object which includes, among other things, the state being
transitioned <code>from</code> and the state being transitioned <code>to</code>.  In this example, the
latter is exactly what we want, so, we&#39;ll just destructure it right off.</p>
<pre><code class="language-javascript"><span class="hl-2">traffic_light</span><span class="hl-1">.</span><span class="hl-6">hook_any_transition</span><span class="hl-1">( ({ </span><span class="hl-2">to</span><span class="hl-1"> }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-6">set_color</span><span class="hl-1">(</span><span class="hl-2">to</span><span class="hl-1">) );</span>
</code></pre>
<p>We will also, since we&#39;re working in the console for now, we&#39;ll export the
variable onto <code>window</code> so that we can use it easily in the console.</p>
<pre><code class="language-javascript"><span class="hl-2">window</span><span class="hl-1">.</span><span class="hl-2">tl</span><span class="hl-1"> = </span><span class="hl-2">traffic_light</span><span class="hl-1">;</span>
</code></pre>
<p>Both these lines go at the end of <code>onload</code>, which now looks like this:</p>
<pre><code class="language-javascript"><span class="hl-2">window</span><span class="hl-1">.</span><span class="hl-6">onload</span><span class="hl-1"> = () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">traffic_light</span><span class="hl-1"> = </span><span class="hl-2">window</span><span class="hl-3">.</span><span class="hl-2">jssm</span><span class="hl-3">.</span><span class="hl-6">sm</span><span class="hl-3">`</span><br/><span class="hl-3">    red &#39;next&#39; =&gt; green &#39;next&#39; =&gt; yellow &#39;next&#39; =&gt; red;</span><br/><span class="hl-3">  `</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-2">traffic_light</span><span class="hl-1">.</span><span class="hl-6">hook_any_transition</span><span class="hl-1">( ({</span><span class="hl-2">to</span><span class="hl-1">}) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-6">set_color</span><span class="hl-1">(</span><span class="hl-2">to</span><span class="hl-1">) );</span><br/><span class="hl-1">  </span><span class="hl-2">window</span><span class="hl-1">.</span><span class="hl-2">tl</span><span class="hl-1"> = </span><span class="hl-2">traffic_light</span><span class="hl-1">;</span><br/><br/><span class="hl-1">};</span>
</code></pre>
<p>And now, they&#39;re linked.</p>
<div class="youtube-embed"><iframe src="//www.youtube.com/embed/1Js2-AYaXus?html5=1" frameborder="0" allowfullscreen></iframe></div>





<p>&nbsp;</p>
<p>&nbsp;</p>

<a href="#adding-buttons-to-the-ui" id="adding-buttons-to-the-ui" style="color: inherit; text-decoration: none;">
  <h1>Adding buttons to the UI</h1>
</a>
<p>Of course, we wouldn&#39;t have users use the console; let&#39;s have some widgets wired
up.  Also, while we&#39;re at it, let&#39;s decide what to do about the light being
<code>off</code>.</p>
<p>Realistically, a light can turn off - the power can go out, they can down it for
maintenance, it might be new, et cetera; so, a practical machine should cover
being turned off.  Let&#39;s also.</p>
<p>Our new machine:</p>
<pre><code class="language-javascript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">traffic_light</span><span class="hl-1"> = </span><span class="hl-6">sm</span><span class="hl-3">`</span><br/><span class="hl-3">  off &#39;enable&#39; -&gt; red;</span><br/><span class="hl-3">  red &#39;next&#39; =&gt; green &#39;next&#39; =&gt; yellow &#39;next&#39; =&gt; red;</span><br/><span class="hl-3">  [red yellow green] &#39;disable&#39; -&gt; off;</span><br/><span class="hl-3">`</span><span class="hl-1">;</span>
</code></pre>
<p>We&#39;ve a convention here.  Putting several names in <code>[]</code> square brackets makes a
&quot;list,&quot; and when we make an arrow from the list, it actually makes a distinct
arrow for each element in the list.  So, the line</p>
<pre><code class="language-fsl"><span class="hl-1">[</span><span class="hl-10">red</span><span class="hl-1"> </span><span class="hl-10">yellow</span><span class="hl-1"> </span><span class="hl-10">green</span><span class="hl-1">] </span><span class="hl-4">&#39;disable&#39;</span><span class="hl-1"> </span><span class="hl-0">-&gt;</span><span class="hl-1"> </span><span class="hl-10">off</span><span class="hl-1">;</span>
</code></pre>
<p>actually makes <em>three</em> transitions, and gives them all the same action.</p>
<p>The state machine will now start in <code>off</code>, because unless you specify otherwise,
the first named state is assumed to be the starting state.</p>
<p>We&#39;ll need to add two labelled containers to our UI - one for the available
actions, and one for the available transitions.  Those might initially just be
empty <code>&lt;div&gt;</code>s, and look like this:</p>
<pre><code class="language-html"><span class="hl-11">&lt;</span><span class="hl-10">div</span><span class="hl-1"> </span><span class="hl-12">id</span><span class="hl-1">=</span><span class="hl-14">&quot;avail_actions&quot;</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">div</span><span class="hl-11">&gt;</span><br/><span class="hl-11">&lt;</span><span class="hl-10">div</span><span class="hl-1"> </span><span class="hl-12">id</span><span class="hl-1">=</span><span class="hl-14">&quot;avail_transitions&quot;</span><span class="hl-11">&gt;&lt;/</span><span class="hl-10">div</span><span class="hl-11">&gt;</span>
</code></pre>
<p>Which actions and transitions are available at any given time on this machine
change, and we don&#39;t want to have to manage knowing what&#39;s going on, so we&#39;ll
just dynamically create and destroy whatever the machine says is available
currently, on each transition.</p>
<p>To update the action buttons, list the actions exiting the current state with
<code>machine.list_exit_actions()</code>:</p>
<pre><code class="language-javascript"><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-6">update_action_buttons</span><span class="hl-1">() {</span><br/><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">container</span><span class="hl-1"> = </span><span class="hl-2">document</span><span class="hl-1">.</span><span class="hl-6">getElementById</span><span class="hl-1">(</span><span class="hl-3">&#39;avail_actions&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">container</span><span class="hl-1">.</span><span class="hl-2">innerHTML</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-2">traffic_light</span><span class="hl-1">.</span><span class="hl-6">list_exit_actions</span><span class="hl-1">().</span><span class="hl-6">forEach</span><span class="hl-1">( </span><span class="hl-2">ea</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">newButton</span><span class="hl-1">     = </span><span class="hl-2">document</span><span class="hl-1">.</span><span class="hl-6">createElement</span><span class="hl-1">(</span><span class="hl-3">&#39;button&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">newButton</span><span class="hl-1">.</span><span class="hl-2">innerHTML</span><span class="hl-1"> = </span><span class="hl-2">ea</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">newButton</span><span class="hl-1">.</span><span class="hl-6">onclick</span><span class="hl-1">   = () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">traffic_light</span><span class="hl-1">.</span><span class="hl-6">action</span><span class="hl-1">(</span><span class="hl-2">ea</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">container</span><span class="hl-1">.</span><span class="hl-6">appendChild</span><span class="hl-1">(</span><span class="hl-2">newButton</span><span class="hl-1">);</span><br/><span class="hl-1">  } );</span><br/><br/><span class="hl-1">}</span>
</code></pre>
<p>And almost identical, to update the transition buttons, list the relevant
exiting transitions with <code>machine.list_exits()</code>:</p>
<pre><code class="language-javascript"><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-6">update_transition_buttons</span><span class="hl-1">() {</span><br/><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">container</span><span class="hl-1"> = </span><span class="hl-2">document</span><span class="hl-1">.</span><span class="hl-6">getElementById</span><span class="hl-1">(</span><span class="hl-3">&#39;avail_transitions&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">container</span><span class="hl-1">.</span><span class="hl-2">innerHTML</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-2">traffic_light</span><span class="hl-1">.</span><span class="hl-6">list_exits</span><span class="hl-1">().</span><span class="hl-6">forEach</span><span class="hl-1">( </span><span class="hl-2">et</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">newButton</span><span class="hl-1">     = </span><span class="hl-2">document</span><span class="hl-1">.</span><span class="hl-6">createElement</span><span class="hl-1">(</span><span class="hl-3">&#39;button&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">newButton</span><span class="hl-1">.</span><span class="hl-2">innerHTML</span><span class="hl-1"> = </span><span class="hl-2">et</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">newButton</span><span class="hl-1">.</span><span class="hl-6">onclick</span><span class="hl-1">   = () </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">traffic_light</span><span class="hl-1">.</span><span class="hl-6">action</span><span class="hl-1">(</span><span class="hl-2">et</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">container</span><span class="hl-1">.</span><span class="hl-6">appendChild</span><span class="hl-1">(</span><span class="hl-2">newButton</span><span class="hl-1">);</span><br/><span class="hl-1">  } );</span><br/><br/><span class="hl-1">}</span>
</code></pre>
<p>Finally, we call both updates in an entry hook, as well as when the
webpage is being set up initially:</p>
<pre><code class="language-javascript"><span class="hl-1">  </span><span class="hl-2">traffic_light</span><span class="hl-1">.</span><span class="hl-6">hook_entry</span><span class="hl-1">( () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">update_action_buttons</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">update_transition_buttons</span><span class="hl-1">();</span><br/><span class="hl-1">  } );</span>
</code></pre>
<pre><code class="language-javascript"><span class="hl-2">window</span><span class="hl-1">.</span><span class="hl-6">onload</span><span class="hl-1"> = () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">// ...</span><br/><span class="hl-1">  </span><span class="hl-6">update_action_buttons</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-6">update_transition_buttons</span><span class="hl-1">();</span><br/><span class="hl-1">};</span>
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Modules</a></li><li class="current pages-entry pages-entry-menu pages-entry-depth-0"><a>Tutorials</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-1"><a href="WhatAreStateMachines.html">What are state machines?</a></li><li class="current pages-entry pages-entry-page pages-entry-depth-1"><a href="GettingStarted.html">☕ <wbr/>Quick <wbr/>Start</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-1"><a href="LanguageReference.html">Language reference</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-1"><a href="todo.html">API reference</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-1"><a href="ExampleMachines.html">Example machines</a></li><li class=" pages-entry pages-entry-menu pages-entry-depth-1"><a>Howtos and <wbr/>Recipes</a></li><li class=" pages-entry pages-entry-menu pages-entry-depth-2"><a>Frameworks</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">React</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Vue</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Angular</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Node</a></li><li class=" pages-entry pages-entry-menu pages-entry-depth-2"><a>Environments</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Node</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Typescript</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">The browser</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="Environments_Deno.html">Deno</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">AWS <wbr/>Lambda</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">SQL</a></li><li class=" pages-entry pages-entry-menu pages-entry-depth-2"><a>Bundling</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Rollup</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Webpack</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">CDN</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-3"><a href="todo.html">Local files</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-2"><a href="todo.html">Let&#39;s make a large machine</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-2"><a href="todo.html">Publishing</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-2"><a href="Styling.html">Theme, style, color</a></li><li class=" pages-entry pages-entry-menu pages-entry-depth-1"><a>Comparisons</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-2"><a href="FeatureComparison.html">Feature comparison</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-2"><a href="Shootout.html">LOC <wbr/>Shootout</a></li><li class=" pages-entry pages-entry-menu pages-entry-depth-0"><a>Tools</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-1"><a href="live_editor.html">Live <wbr/>Editor</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-1"><a href="todo.html">Github <wbr/>Action</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-1"><a href="todo.html">CLI</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-0"><a href="community.html">Community</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-0"><a href="CHANGELOG.long.html">Changelog</a></li><li class=" tsd-kind-module"><a href="../modules/jssm.html">jssm</a></li><li class=" tsd-kind-module"><a href="../modules/jssm_constants.html">jssm_<wbr/>constants</a></li><li class=" tsd-kind-module"><a href="../modules/jssm_error.html">jssm_<wbr/>error</a></li><li class=" tsd-kind-module"><a href="../modules/jssm_types.html">jssm_<wbr/>types</a></li><li class=" tsd-kind-module"><a href="../modules/jssm_util.html">jssm_<wbr/>util</a></li><li class=" tsd-kind-module"><a href="../modules/version.html">version</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-namespace"><span class="tsd-kind-icon">Namespace</span></li><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li><li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li><li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>